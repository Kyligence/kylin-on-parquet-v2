{
  "uuid" : "b6b8be81-e5cd-4a48-a04a-e931073ce89b",
  "last_modified" : 1576664965482,
  "version" : "3.0.0.20500",
  "content" : "org.apache.kylin.job.exception.ExecuteException: java.lang.reflect.InvocationTargetException\n\tat org.apache.kylin.job.execution.AbstractExecutable.execute(AbstractExecutable.java:205)\n\tat org.apache.kylin.job.execution.DefaultChainedExecutable.doWork(DefaultChainedExecutable.java:76)\n\tat org.apache.kylin.job.execution.AbstractExecutable.execute(AbstractExecutable.java:190)\n\tat org.apache.kylin.job.impl.threadpool.DefaultScheduler$JobRunner.run(DefaultScheduler.java:114)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat io.kyligence.kap.engine.spark.job.NSparkExecutable.runLocalMode(NSparkExecutable.java:359)\n\tat io.kyligence.kap.engine.spark.job.NSparkExecutable.doWork(NSparkExecutable.java:153)\n\tat org.apache.kylin.job.execution.AbstractExecutable.execute(AbstractExecutable.java:190)\n\t... 6 more\nCaused by: java.lang.RuntimeException: Error execute io.kyligence.kap.engine.spark.job.ResourceDetectBeforeCubingJob\n\tat io.kyligence.kap.engine.spark.application.SparkApplication.execute(SparkApplication.java:89)\n\tat io.kyligence.kap.engine.spark.job.ResourceDetectBeforeCubingJob.main(ResourceDetectBeforeCubingJob.java:99)\n\t... 13 more\nCaused by: org.apache.spark.sql.AnalysisException: cannot resolve '`BUYER_ACCOUNT_0_DOT_0_ACCOUNT_COUNTRY`' given input columns: [TEST_CAL_DT_0_DOT_0_AGE_FOR_WEEK_ID, TEST_CAL_DT_0_DOT_0_YTM_YN_ID, TEST_CAL_DT_0_DOT_0_WEEK_BEG_DATE, TEST_KYLIN_FACT_0_DOT_0_CAL_DT, TEST_CAL_DT_0_DOT_0_QTR_ID, TEST_CAL_DT_0_DOT_0_CAL_DATE, TEST_SITES_0_DOT_0_CRE_DATE, TEST_CAL_DT_0_DOT_0_WEEK_IN_YEAR_ID, TEST_CAL_DT_0_DOT_0_WEEK_OF_CAL_ID, TEST_CAL_DT_0_DOT_0_CURR_CAL_DT_MNS_1MONTH_YN_ID, TEST_CAL_DT_0_DOT_0_CURR_CAL_DT_MNS_1YEAR_YN_ID, TEST_CAL_DT_0_DOT_0_RTL_QTR_OF_RTL_YEAR_ID, TEST_CAL_DT_0_DOT_0_YEAR_BEG_DT, TEST_SITES_0_DOT_0_SITE_CNTRY_ID, TEST_CAL_DT_0_DOT_0_DAY_OF_WEEK_ID, TEST_CAL_DT_0_DOT_0_WEEK_BEG_END_DESC_MDY, TEST_CAL_DT_0_DOT_0_QTR_BEG_DT, TEST_CAL_DT_0_DOT_0_WTD_YN_ID, TEST_CAL_DT_0_DOT_0_WEEK_ID, TEST_CAL_DT_0_DOT_0_RTL_MONTH_OF_RTL_YEAR_ID, TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_WEEK_ID, TEST_CAL_DT_0_DOT_0_MONTH_OF_YEAR_ID, TEST_CAL_DT_0_DOT_0_AGE_FOR_CS_WEEK_ID, TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_MONTH_ID, TEST_CAL_DT_0_DOT_0_PRD_DESC, TEST_KYLIN_FACT_0_DOT_0_SLR_SEGMENT_CD, TEST_CAL_DT_0_DOT_0_YTQ_YN_ID, TEST_CAL_DT_0_DOT_0_CAL_DT_UPD_DATE, TEST_SITES_0_DOT_0_SITES_UPD_DATE, TEST_CAL_DT_0_DOT_0_WEEK_END_DT, TEST_CAL_DT_0_DOT_0_CAL_DT_DESC, BUYER_COUNTRY_0_DOT_0_COUNTRY, TEST_CAL_DT_0_DOT_0_CAL_DT, TEST_CAL_DT_0_DOT_0_AGE_FOR_QTR_ID, TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_YEAR_ID, TEST_CAL_DT_0_DOT_0_MONTH_BEG_DT, TEST_KYLIN_FACT_0_DOT_0_LSTG_SITE_ID, TEST_CAL_DT_0_DOT_0_CAL_DT_MNS_2MONTH_DT, TEST_CAL_DT_0_DOT_0_QTD_YN_ID, TEST_CAL_DT_0_DOT_0_WEEK_NUM_DESC, TEST_CAL_DT_0_DOT_0_MONTH_OF_CAL_ID, TEST_CAL_DT_0_DOT_0_CURR_CAL_DT_MNS_2MONTH_YN_ID, TEST_CAL_DT_0_DOT_0_CAL_DT_MNS_2YEAR_DT, TEST_CAL_DT_0_DOT_0_RETAIL_START_DATE, TEST_CAL_DT_0_DOT_0_WEEK_BEG_END_DESC_MD, TEST_CAL_DT_0_DOT_0_DAY_OF_CAL_ID, TEST_CAL_DT_0_DOT_0_YTW_YN_ID, TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_QTR_ID, TEST_KYLIN_FACT_0_DOT_0_TEST_COUNT_COLUMN, BUYER_COUNTRY_0_DOT_0_LATITUDE, TEST_CAL_DT_0_DOT_0_CAL_DT_MNS_1MONTH_DT, TEST_CAL_DT_0_DOT_0_RETAIL_YEAR, TEST_SITES_0_DOT_0_EOA_EMAIL_CSTMZBL_SITE_YN_ID, TEST_CAL_DT_0_DOT_0_CAL_DT_SHORT_NAME, TEST_CAL_DT_0_DOT_0_CAL_DT_MNS_1QTR_DT, TEST_CAL_DT_0_DOT_0_DAY_IN_WEEK_COUNT, TEST_CAL_DT_0_DOT_0_RTL_QTR_BEG_DT, TEST_CAL_DT_0_DOT_0_QTR_DESC, BUYER_COUNTRY_0_DOT_0_NAME, TEST_SITES_0_DOT_0_SITE_DOMAIN_CODE, TEST_CAL_DT_0_DOT_0_DAY_OF_QTR_ID, TEST_CAL_DT_0_DOT_0_YEAR_IND, TEST_KYLIN_FACT_0_DOT_0_TEST_COUNT_DISTINCT_BITMAP, TEST_CAL_DT_0_DOT_0_RTL_WEEK_BEG_DT, TEST_CAL_DT_0_DOT_0_CAL_DT_NAME, TEST_CAL_DT_0_DOT_0_QTR_OF_CAL_ID, TEST_CAL_DT_0_DOT_0_MONTH_OF_QTR_ID, TEST_CAL_DT_0_DOT_0_PRD_ID, TEST_SITES_0_DOT_0_SITES_UPD_USER, TEST_CAL_DT_0_DOT_0_CURR_CAL_DT_MNS_1WEEK_YN_IND, TEST_CAL_DT_0_DOT_0_DAY_IN_YEAR_COUNT, TEST_KYLIN_FACT_0_DOT_0_ITEM_COUNT, TEST_CAL_DT_0_DOT_0_RETAIL_WEEK, TEST_CAL_DT_0_DOT_0_PRD_FLAG, TEST_KYLIN_FACT_0_DOT_0_LSTG_FORMAT_NAME, TEST_CAL_DT_0_DOT_0_YEAR_OF_CAL_ID, TEST_CAL_DT_0_DOT_0_RTL_YEAR_BEG_DT, TEST_CAL_DT_0_DOT_0_CAL_DT_MNS_2WEEK_DT, TEST_CAL_DT_0_DOT_0_CURR_CAL_DT_MNS_2WEEK_YN_IND, TEST_CAL_DT_0_DOT_0_SEASON_OF_YEAR_ID, TEST_CAL_DT_0_DOT_0_RTL_WEEK_OF_RTL_YEAR_ID, TEST_SITES_0_DOT_0_CRE_USER, TEST_SITES_0_DOT_0_SITE_NAME, TEST_CAL_DT_0_DOT_0_QTR_OF_YEAR_ID, TEST_CAL_DT_0_DOT_0_RTL_MONTH_BEG_DT, TEST_CAL_DT_0_DOT_0_YEAR_ID, TEST_CAL_DT_0_DOT_0_WEEK_END_DATE, TEST_CAL_DT_0_DOT_0_YEAR_END_DT, TEST_CAL_DT_0_DOT_0_CAL_DT_UPD_USER, TEST_CAL_DT_0_DOT_0_AGE_FOR_MONTH_ID, TEST_CAL_DT_0_DOT_0_WEEK_OF_YEAR_ID, TEST_KYLIN_FACT_0_DOT_0_TRANS_ID, TEST_CAL_DT_0_DOT_0_DAY_OF_WEEK, TEST_CAL_DT_0_DOT_0_CURR_CAL_DT_MNS_1QTR_YN_ID, TEST_CAL_DT_0_DOT_0_DAY_IN_MONTH_COUNT, TEST_CAL_DT_0_DOT_0_CAL_DT_CRE_USER, BUYER_COUNTRY_0_DOT_0_LONGITUDE, TEST_CAL_DT_0_DOT_0_CAL_DT_MNS_1WEEK_DT, TEST_CAL_DT_0_DOT_0_QTR_END_DT, TEST_SITES_0_DOT_0_DFAULT_LSTG_CURNCY, TEST_KYLIN_FACT_0_DOT_0_LEAF_CATEG_ID, TEST_CAL_DT_0_DOT_0_QTR_IND, TEST_SITES_0_DOT_0_SITE_ID, TEST_CAL_DT_0_DOT_0_DAY_OF_MONTH_ID, TEST_CAL_DT_0_DOT_0_CAL_DT_MNS_1YEAR_DT, TEST_CAL_DT_0_DOT_0_MONTH_ID, TEST_CAL_DT_0_DOT_0_YTD_YN_ID, TEST_CAL_DT_0_DOT_0_DAY_IN_QTR_COUNT, TEST_KYLIN_FACT_0_DOT_0_PRICE, TEST_CAL_DT_0_DOT_0_RETAIL_WK_END_DATE, TEST_CAL_DT_0_DOT_0_CAL_DT_MNS_2QTR_DT, TEST_CAL_DT_0_DOT_0_WEEK_BEG_DT, TEST_CAL_DT_0_DOT_0_MTD_YN_ID, TEST_CAL_DT_0_DOT_0_CURR_CAL_DT_MNS_2QTR_YN_ID, TEST_KYLIN_FACT_0_DOT_0_ORDER_ID, TEST_CAL_DT_0_DOT_0_MONTH_END_DT, TEST_CAL_DT_0_DOT_0_CURR_CAL_DT_MNS_2YEAR_YN_ID, TEST_KYLIN_FACT_0_DOT_0_SELLER_ID, TEST_CAL_DT_0_DOT_0_AGE_FOR_DT_ID, TEST_CAL_DT_0_DOT_0_WEEK_IND, TEST_CAL_DT_0_DOT_0_CAL_DT_CRE_DATE, TEST_CAL_DT_0_DOT_0_AGE_FOR_YEAR_ID, TEST_CAL_DT_0_DOT_0_SEASON_BEG_DT, TEST_CAL_DT_0_DOT_0_DAY_OF_YEAR_ID, TEST_CAL_DT_0_DOT_0_PRD_IND, TEST_CAL_DT_0_DOT_0_CS_WEEK_BEG_DT];;\n'Join Inner, ('BUYER_ACCOUNT_0_DOT_0_ACCOUNT_COUNTRY = BUYER_COUNTRY_0_DOT_0_COUNTRY#1953)\n:- Join Inner, (TEST_KYLIN_FACT_0_DOT_0_LSTG_SITE_ID#58 = TEST_SITES_0_DOT_0_SITE_ID#1550)\n:  :- Join Inner, (TEST_KYLIN_FACT_0_DOT_0_CAL_DT#52 = TEST_CAL_DT_0_DOT_0_CAL_DT#570)\n:  :  :- Project [TEST_KYLIN_FACT_0_DOT_0_TRANS_ID#49L, TEST_KYLIN_FACT_0_DOT_0_ORDER_ID#50L, TEST_KYLIN_FACT_0_DOT_0_CAL_DT#52, TEST_KYLIN_FACT_0_DOT_0_LSTG_FORMAT_NAME#54, TEST_KYLIN_FACT_0_DOT_0_LEAF_CATEG_ID#55L, TEST_KYLIN_FACT_0_DOT_0_LSTG_SITE_ID#58, TEST_KYLIN_FACT_0_DOT_0_SLR_SEGMENT_CD#62, TEST_KYLIN_FACT_0_DOT_0_SELLER_ID#64, TEST_KYLIN_FACT_0_DOT_0_PRICE#66, TEST_KYLIN_FACT_0_DOT_0_ITEM_COUNT#68, TEST_KYLIN_FACT_0_DOT_0_TEST_COUNT_DISTINCT_BITMAP#70, TEST_KYLIN_FACT_0_DOT_0_TEST_COUNT_COLUMN#71]\n:  :  :  +- Project [TRANS_ID#12L AS TEST_KYLIN_FACT_0_DOT_0_TRANS_ID#49L, ORDER_ID#13L AS TEST_KYLIN_FACT_0_DOT_0_ORDER_ID#50L, CAL_DT#14 AS TEST_KYLIN_FACT_0_DOT_0_CAL_DT#52, LSTG_FORMAT_NAME#15 AS TEST_KYLIN_FACT_0_DOT_0_LSTG_FORMAT_NAME#54, LEAF_CATEG_ID#16L AS TEST_KYLIN_FACT_0_DOT_0_LEAF_CATEG_ID#55L, LSTG_SITE_ID#17 AS TEST_KYLIN_FACT_0_DOT_0_LSTG_SITE_ID#58, SLR_SEGMENT_CD#18 AS TEST_KYLIN_FACT_0_DOT_0_SLR_SEGMENT_CD#62, SELLER_ID#19 AS TEST_KYLIN_FACT_0_DOT_0_SELLER_ID#64, PRICE#20 AS TEST_KYLIN_FACT_0_DOT_0_PRICE#66, ITEM_COUNT#21 AS TEST_KYLIN_FACT_0_DOT_0_ITEM_COUNT#68, TEST_COUNT_DISTINCT_BITMAP#22 AS TEST_KYLIN_FACT_0_DOT_0_TEST_COUNT_DISTINCT_BITMAP#70, TEST_COUNT_COLUMN#23 AS TEST_KYLIN_FACT_0_DOT_0_TEST_COUNT_COLUMN#71]\n:  :  :     +- SubqueryAlias `TEST_KYLIN_FACT`\n:  :  :        +- Relation[TRANS_ID#12L,ORDER_ID#13L,CAL_DT#14,LSTG_FORMAT_NAME#15,LEAF_CATEG_ID#16L,LSTG_SITE_ID#17,SLR_SEGMENT_CD#18,SELLER_ID#19,PRICE#20,ITEM_COUNT#21,TEST_COUNT_DISTINCT_BITMAP#22,TEST_COUNT_COLUMN#23] csv\n:  :  +- Project [TEST_CAL_DT_0_DOT_0_CAL_DT#570, TEST_CAL_DT_0_DOT_0_YEAR_BEG_DT#571, TEST_CAL_DT_0_DOT_0_QTR_BEG_DT#572, TEST_CAL_DT_0_DOT_0_MONTH_BEG_DT#573, TEST_CAL_DT_0_DOT_0_WEEK_BEG_DT#574, TEST_CAL_DT_0_DOT_0_AGE_FOR_YEAR_ID#575, TEST_CAL_DT_0_DOT_0_AGE_FOR_QTR_ID#576, TEST_CAL_DT_0_DOT_0_AGE_FOR_MONTH_ID#577, TEST_CAL_DT_0_DOT_0_AGE_FOR_WEEK_ID#578, TEST_CAL_DT_0_DOT_0_AGE_FOR_DT_ID#579, TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_YEAR_ID#580, TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_QTR_ID#581, TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_MONTH_ID#582, TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_WEEK_ID#583, TEST_CAL_DT_0_DOT_0_AGE_FOR_CS_WEEK_ID#584, TEST_CAL_DT_0_DOT_0_DAY_OF_CAL_ID#585, TEST_CAL_DT_0_DOT_0_DAY_OF_YEAR_ID#586, TEST_CAL_DT_0_DOT_0_DAY_OF_QTR_ID#587, TEST_CAL_DT_0_DOT_0_DAY_OF_MONTH_ID#588, TEST_CAL_DT_0_DOT_0_DAY_OF_WEEK_ID#589, TEST_CAL_DT_0_DOT_0_WEEK_OF_YEAR_ID#590, TEST_CAL_DT_0_DOT_0_WEEK_OF_CAL_ID#591, TEST_CAL_DT_0_DOT_0_MONTH_OF_QTR_ID#592, TEST_CAL_DT_0_DOT_0_MONTH_OF_YEAR_ID#593, ... 76 more fields]\n:  :     +- Project [CAL_DT#170 AS TEST_CAL_DT_0_DOT_0_CAL_DT#570, YEAR_BEG_DT#171 AS TEST_CAL_DT_0_DOT_0_YEAR_BEG_DT#571, QTR_BEG_DT#172 AS TEST_CAL_DT_0_DOT_0_QTR_BEG_DT#572, MONTH_BEG_DT#173 AS TEST_CAL_DT_0_DOT_0_MONTH_BEG_DT#573, WEEK_BEG_DT#174 AS TEST_CAL_DT_0_DOT_0_WEEK_BEG_DT#574, AGE_FOR_YEAR_ID#175 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_YEAR_ID#575, AGE_FOR_QTR_ID#176 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_QTR_ID#576, AGE_FOR_MONTH_ID#177 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_MONTH_ID#577, AGE_FOR_WEEK_ID#178 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_WEEK_ID#578, AGE_FOR_DT_ID#179 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_DT_ID#579, AGE_FOR_RTL_YEAR_ID#180 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_YEAR_ID#580, AGE_FOR_RTL_QTR_ID#181 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_QTR_ID#581, AGE_FOR_RTL_MONTH_ID#182 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_MONTH_ID#582, AGE_FOR_RTL_WEEK_ID#183 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_RTL_WEEK_ID#583, AGE_FOR_CS_WEEK_ID#184 AS TEST_CAL_DT_0_DOT_0_AGE_FOR_CS_WEEK_ID#584, DAY_OF_CAL_ID#185 AS TEST_CAL_DT_0_DOT_0_DAY_OF_CAL_ID#585, DAY_OF_YEAR_ID#186 AS TEST_CAL_DT_0_DOT_0_DAY_OF_YEAR_ID#586, DAY_OF_QTR_ID#187 AS TEST_CAL_DT_0_DOT_0_DAY_OF_QTR_ID#587, DAY_OF_MONTH_ID#188 AS TEST_CAL_DT_0_DOT_0_DAY_OF_MONTH_ID#588, DAY_OF_WEEK_ID#189 AS TEST_CAL_DT_0_DOT_0_DAY_OF_WEEK_ID#589, WEEK_OF_YEAR_ID#190 AS TEST_CAL_DT_0_DOT_0_WEEK_OF_YEAR_ID#590, WEEK_OF_CAL_ID#191 AS TEST_CAL_DT_0_DOT_0_WEEK_OF_CAL_ID#591, MONTH_OF_QTR_ID#192 AS TEST_CAL_DT_0_DOT_0_MONTH_OF_QTR_ID#592, MONTH_OF_YEAR_ID#193 AS TEST_CAL_DT_0_DOT_0_MONTH_OF_YEAR_ID#593, ... 76 more fields]\n:  :        +- SubqueryAlias `TEST_CAL_DT`\n:  :           +- Relation[CAL_DT#170,YEAR_BEG_DT#171,QTR_BEG_DT#172,MONTH_BEG_DT#173,WEEK_BEG_DT#174,AGE_FOR_YEAR_ID#175,AGE_FOR_QTR_ID#176,AGE_FOR_MONTH_ID#177,AGE_FOR_WEEK_ID#178,AGE_FOR_DT_ID#179,AGE_FOR_RTL_YEAR_ID#180,AGE_FOR_RTL_QTR_ID#181,AGE_FOR_RTL_MONTH_ID#182,AGE_FOR_RTL_WEEK_ID#183,AGE_FOR_CS_WEEK_ID#184,DAY_OF_CAL_ID#185,DAY_OF_YEAR_ID#186,DAY_OF_QTR_ID#187,DAY_OF_MONTH_ID#188,DAY_OF_WEEK_ID#189,WEEK_OF_YEAR_ID#190,WEEK_OF_CAL_ID#191,MONTH_OF_QTR_ID#192,MONTH_OF_YEAR_ID#193,... 76 more fields] csv\n:  +- Project [TEST_SITES_0_DOT_0_SITE_ID#1550, TEST_SITES_0_DOT_0_SITE_NAME#1551, TEST_SITES_0_DOT_0_SITE_DOMAIN_CODE#1552, TEST_SITES_0_DOT_0_DFAULT_LSTG_CURNCY#1553, TEST_SITES_0_DOT_0_EOA_EMAIL_CSTMZBL_SITE_YN_ID#1554, TEST_SITES_0_DOT_0_SITE_CNTRY_ID#1555, TEST_SITES_0_DOT_0_CRE_DATE#1556, TEST_SITES_0_DOT_0_SITES_UPD_DATE#1557, TEST_SITES_0_DOT_0_CRE_USER#1558, TEST_SITES_0_DOT_0_SITES_UPD_USER#1559]\n:     +- Project [SITE_ID#1530 AS TEST_SITES_0_DOT_0_SITE_ID#1550, SITE_NAME#1531 AS TEST_SITES_0_DOT_0_SITE_NAME#1551, SITE_DOMAIN_CODE#1532 AS TEST_SITES_0_DOT_0_SITE_DOMAIN_CODE#1552, DFAULT_LSTG_CURNCY#1533 AS TEST_SITES_0_DOT_0_DFAULT_LSTG_CURNCY#1553, EOA_EMAIL_CSTMZBL_SITE_YN_ID#1534 AS TEST_SITES_0_DOT_0_EOA_EMAIL_CSTMZBL_SITE_YN_ID#1554, SITE_CNTRY_ID#1535 AS TEST_SITES_0_DOT_0_SITE_CNTRY_ID#1555, CRE_DATE#1536 AS TEST_SITES_0_DOT_0_CRE_DATE#1556, SITES_UPD_DATE#1537 AS TEST_SITES_0_DOT_0_SITES_UPD_DATE#1557, CRE_USER#1538 AS TEST_SITES_0_DOT_0_CRE_USER#1558, SITES_UPD_USER#1539 AS TEST_SITES_0_DOT_0_SITES_UPD_USER#1559]\n:        +- SubqueryAlias `TEST_SITES`\n:           +- Relation[SITE_ID#1530,SITE_NAME#1531,SITE_DOMAIN_CODE#1532,DFAULT_LSTG_CURNCY#1533,EOA_EMAIL_CSTMZBL_SITE_YN_ID#1534,SITE_CNTRY_ID#1535,CRE_DATE#1536,SITES_UPD_DATE#1537,CRE_USER#1538,SITES_UPD_USER#1539] csv\n+- Project [BUYER_COUNTRY_0_DOT_0_COUNTRY#1953, BUYER_COUNTRY_0_DOT_0_LATITUDE#1954, BUYER_COUNTRY_0_DOT_0_LONGITUDE#1955, BUYER_COUNTRY_0_DOT_0_NAME#1956]\n   +- Project [COUNTRY#1945 AS BUYER_COUNTRY_0_DOT_0_COUNTRY#1953, LATITUDE#1946 AS BUYER_COUNTRY_0_DOT_0_LATITUDE#1954, LONGITUDE#1947 AS BUYER_COUNTRY_0_DOT_0_LONGITUDE#1955, NAME#1948 AS BUYER_COUNTRY_0_DOT_0_NAME#1956]\n      +- SubqueryAlias `BUYER_COUNTRY`\n         +- Relation[COUNTRY#1945,LATITUDE#1946,LONGITUDE#1947,NAME#1948] csv\n\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$3.applyOrElse(CheckAnalysis.scala:110)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$3.applyOrElse(CheckAnalysis.scala:107)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:278)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:278)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:277)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$3.apply(TreeNode.scala:275)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$3.apply(TreeNode.scala:275)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:326)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:324)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:275)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$transformExpressionsUp$1.apply(QueryPlan.scala:93)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$transformExpressionsUp$1.apply(QueryPlan.scala:93)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$1.apply(QueryPlan.scala:105)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$1.apply(QueryPlan.scala:105)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpression$1(QueryPlan.scala:104)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:116)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:117)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$2.apply(QueryPlan.scala:126)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.mapExpressions(QueryPlan.scala:126)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionsUp(QueryPlan.scala:93)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:107)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:85)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:127)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:85)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:95)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$executeAndCheck$1.apply(Analyzer.scala:108)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$executeAndCheck$1.apply(Analyzer.scala:105)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:201)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:105)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:57)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:47)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:78)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:3410)\n\tat org.apache.spark.sql.Dataset.join(Dataset.scala:995)\n\tat io.kyligence.kap.engine.spark.builder.CreateFlatTable$.joinTableDataset(CreateFlatTable.scala:191)\n\tat io.kyligence.kap.engine.spark.builder.CreateFlatTable$$anonfun$joinFactTableWithLookupTables$1.apply(CreateFlatTable.scala:165)\n\tat io.kyligence.kap.engine.spark.builder.CreateFlatTable$$anonfun$joinFactTableWithLookupTables$1.apply(CreateFlatTable.scala:164)\n\tat scala.collection.TraversableOnce$$anonfun$foldLeft$1.apply(TraversableOnce.scala:157)\n\tat scala.collection.TraversableOnce$$anonfun$foldLeft$1.apply(TraversableOnce.scala:157)\n\tat scala.collection.immutable.HashMap$HashMap1.foreach(HashMap.scala:221)\n\tat scala.collection.immutable.HashMap$HashTrieMap.foreach(HashMap.scala:428)\n\tat scala.collection.TraversableOnce$class.foldLeft(TraversableOnce.scala:157)\n\tat scala.collection.AbstractTraversable.foldLeft(Traversable.scala:104)\n\tat io.kyligence.kap.engine.spark.builder.CreateFlatTable$.joinFactTableWithLookupTables(CreateFlatTable.scala:163)\n\tat io.kyligence.kap.engine.spark.builder.CreateFlatTable.generateDataset(CreateFlatTable.scala:68)\n\tat io.kyligence.kap.engine.spark.job.ParentSourceChooser.getFlatTable(ParentSourceChooser.scala:163)\n\tat io.kyligence.kap.engine.spark.job.ParentSourceChooser.io$kyligence$kap$engine$spark$job$ParentSourceChooser$$decideFlatTableSource(ParentSourceChooser.scala:73)\n\tat io.kyligence.kap.engine.spark.job.ParentSourceChooser$$anonfun$decideSources$1.apply(ParentSourceChooser.scala:59)\n\tat io.kyligence.kap.engine.spark.job.ParentSourceChooser$$anonfun$decideSources$1.apply(ParentSourceChooser.scala:54)\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:893)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1336)\n\tat scala.collection.IterableLike$class.foreach(IterableLike.scala:72)\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:54)\n\tat io.kyligence.kap.engine.spark.job.ParentSourceChooser.decideSources(ParentSourceChooser.scala:54)\n\tat io.kyligence.kap.engine.spark.job.ResourceDetectBeforeCubingJob.doExecute(ResourceDetectBeforeCubingJob.java:60)\n\tat io.kyligence.kap.engine.spark.application.SparkApplication.execute(SparkApplication.java:266)\n\tat io.kyligence.kap.engine.spark.application.SparkApplication.execute(SparkApplication.java:86)\n\t... 14 more\n",
  "status" : "ERROR",
  "info" : {
    "startTime" : "1576664952500",
    "buildInstance" : "96649@yimingxumac.local",
    "endTime" : "1576664965468"
  }
}